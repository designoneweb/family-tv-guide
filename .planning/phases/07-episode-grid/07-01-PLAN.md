---
phase: 07-episode-grid
plan: 01
type: execute
---

<objective>
Build art-dominant episode grid view with season navigation for TV shows.

Purpose: Enable users to browse episodes visually before deciding what to watch, with stills as the primary visual element.
Output: Working /app/show/[id] page displaying episodes in a grid with season selector.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase context (most relevant):
@.planning/phases/06-progress-tracking/06-03-SUMMARY.md
@.planning/phases/03-tmdb-integration/03-02-SUMMARY.md

# Key files to reference:
@web/lib/tmdb/details.ts
@web/lib/tmdb/types.ts
@web/lib/tmdb/images.ts
@web/app/api/tmdb/tv/[id]/season/[seasonNumber]/route.ts
@web/components/title-card.tsx

**Tech stack available:**
- Next.js 16.1.3 with App Router
- Supabase auth with @supabase/ssr
- TMDB API integration (server-side proxy)
- shadcn/ui components
- Tailwind CSS dark mode

**Established patterns:**
- TMDB API routes under /api/tmdb/* for client-side fetching
- Image URL helpers: getStillUrl, getPosterUrl, getBackdropUrl
- TitleCard pattern for displaying media items
- Client components with 'use client' directive

**Constraining decisions:**
- Phase 03-02: Image sizes hardcoded (still: w185/w300/w300)
- Phase 03-02: Null-safe returns for missing resources
- Phase 06-02: TMDB client API routes pattern established
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create EpisodeTile component</name>
  <files>web/components/episode-tile.tsx</files>
  <action>Create reusable EpisodeTile component displaying:
- Still image (16:9 aspect ratio) with fallback for missing stills (show film icon + episode number)
- Episode number badge overlay (top-left, "E5" format)
- Episode title (truncated to 1 line)
- Brief description (truncated to 2 lines, text-muted-foreground)
- Air date in muted text

Use getStillUrl from @/lib/tmdb/images for image URL construction.
Use Next.js Image component with unoptimized prop (TMDB images).
Make component accept onClick prop for future navigation to episode detail.
Use bg-card with rounded-lg border for consistent styling with TitleCard pattern.

Props interface:
- episodeNumber: number
- seasonNumber: number
- name: string
- overview: string
- stillPath: string | null
- airDate: string
- onClick?: () => void

Note: Guest stars preview deferred to Phase 8 (Episode Detail) - TMDB episode endpoint returns guest_stars but requires separate API call for each episode which would be expensive for grid view.</action>
  <verify>File exists at web/components/episode-tile.tsx with proper TypeScript types and exports</verify>
  <done>EpisodeTile component created with still image, title, description, air date, and fallback handling</done>
</task>

<task type="auto">
  <name>Task 2: Create show page with episode grid</name>
  <files>web/app/app/show/[id]/page.tsx, web/app/app/show/[id]/show-client.tsx</files>
  <action>Create TV show page at /app/show/[id] displaying:

1. Server component (page.tsx):
   - Extract show ID from params
   - Render ShowClient component

2. Client component (show-client.tsx):
   - Fetch TV details from /api/tmdb/tv/[id] to get show name, number_of_seasons, backdrop_path
   - Fetch season data from /api/tmdb/tv/[id]/season/[seasonNumber]
   - Default to season 1 on load

Layout structure:
- Show title as h1 at top
- Backdrop image behind title (optional, if backdrop_path exists)
- Season selector: horizontal tabs or Select dropdown showing "Season 1", "Season 2", etc.
- Episode grid: responsive grid (1 col mobile, 2 cols tablet, 3-4 cols desktop)
- Use grid gap-4 or gap-6 for spacing

Season selector behavior:
- Show tabs if â‰¤6 seasons, otherwise use Select dropdown
- Changing season fetches new season data and re-renders grid
- Loading state while fetching (skeleton or spinner)

Map season.episodes to EpisodeTile components.
Handle loading and error states gracefully.

Note: For now, clicking an episode tile does nothing (Phase 8 adds episode detail page).</action>
  <verify>Navigate to /app/show/[tmdb_id] (use a known show ID like 1399 for Game of Thrones) and see episode grid with season selector</verify>
  <done>Show page displays episode grid with still images, season selector allows switching between seasons</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Episode grid page with art-dominant layout and season navigation</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/app/show/1399 (Game of Thrones - 8 seasons)
    3. Verify: Episode stills display in grid (16:9 aspect ratio)
    4. Verify: Episode titles and descriptions show below each still
    5. Verify: Season selector appears (dropdown for 8 seasons)
    6. Test: Switch to Season 2, verify new episodes load
    7. Test: Visit /app/show/60735 (The Flash - many seasons) to test dropdown
    8. Test: Visit /app/show/76479 (The Boys - fewer seasons) to test tabs
    9. Verify: Episodes without stills show fallback gracefully
    10. Verify: Responsive layout on mobile (1 col) vs desktop (3-4 cols)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run build` succeeds without errors
- [ ] EpisodeTile component renders correctly with various data
- [ ] Show page fetches and displays TMDB data
- [ ] Season selector switches between seasons
- [ ] Missing stills show fallback
- [ ] Responsive grid layout works across breakpoints
</verification>

<success_criteria>

- EpisodeTile component created and exported
- Show page accessible at /app/show/[id]
- Episode grid displays stills in art-dominant layout
- Season selector allows navigation between seasons
- Graceful fallback for missing still images
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-episode-grid/07-01-SUMMARY.md`
</output>
