---
phase: 06-progress-tracking
plan: 03
type: execute
---

<objective>
Implement Jump to Episode functionality allowing users to manually set their current episode for any TV show.

Purpose: Enable corrections (started mid-season) and binge catch-up (watched 5 episodes, want to jump ahead).
Output: Episode selector dialog accessible from TitleCard, with season/episode dropdowns that update progress.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary-template.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior plan context:**
@.planning/phases/06-progress-tracking/06-02-SUMMARY.md

**Existing components:**
@web/components/title-card.tsx
@web/app/app/tonight/tonight-client.tsx
@web/components/add-to-schedule-dialog.tsx (dialog pattern reference)

**Progress API:**
@web/app/api/progress/route.ts
@web/lib/tmdb/details.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Jump to Episode dialog component</name>
  <files>web/components/jump-to-episode-dialog.tsx</files>
  <action>
Create JumpToEpisodeDialog component following add-to-schedule-dialog.tsx patterns:

Props:
- open: boolean
- onOpenChange: (open: boolean) => void
- trackedTitleId: string
- tmdbId: number
- currentSeason: number
- currentEpisode: number
- onSuccess: (newSeason: number, newEpisode: number) => void

Behavior:
1. On open, fetch TV details using getTVDetails(tmdbId) to get number_of_seasons
2. Fetch season details for current season using getTVSeason(tmdbId, seasonNumber) to get episode list
3. Display two selects:
   - Season dropdown: 1 to number_of_seasons
   - Episode dropdown: 1 to episodes.length (updates when season changes)
4. Pre-select current season/episode values
5. When season changes: fetch new season's episodes, reset episode to 1
6. Save button: POST /api/progress with new season/episode
7. On success: call onSuccess callback, close dialog

UI Components (use existing shadcn):
- Dialog, DialogContent, DialogHeader, DialogTitle
- Select, SelectTrigger, SelectContent, SelectItem
- Button (Save, Cancel)
- Loader2 for loading states

Error handling:
- Show loading spinner while fetching seasons/episodes
- Disable Save while loading or no changes
- Show error toast on failure
  </action>
  <verify>TypeScript compiles: cd web && npx tsc --noEmit</verify>
  <done>JumpToEpisodeDialog component exists with season/episode selection and save functionality</done>
</task>

<task type="auto">
  <name>Task 2: Integrate Jump to Episode into TitleCard</name>
  <files>web/components/title-card.tsx, web/app/app/tonight/tonight-client.tsx</files>
  <action>
1. Add Jump to Episode trigger to TitleCard:
   - Add a "..." or menu button (MoreVertical icon) for TV shows
   - On click: set state to open JumpToEpisodeDialog
   - Alternative: Make episode text clickable ("S1E5: Title" opens dialog)

2. Add props to TitleCard:
   - onJumpToEpisode?: (newSeason: number, newEpisode: number) => void

3. Add dialog state to TitleCard:
   - jumpDialogOpen: boolean
   - Render JumpToEpisodeDialog when open

4. In tonight-client.tsx:
   - Create handleJumpToEpisode(trackedTitleId, newSeason, newEpisode) function:
     a. Update local entry.currentEpisode with new values
     b. Fetch new episode title from TMDB (optional, or update on next refresh)
   - Pass onJumpToEpisode to each TitleCard

5. Consider UX:
   - Episode text acts as link/button: "S1E5: Pilot" (clickable)
   - Tooltip: "Click to change episode"
   - Cursor: pointer
  </action>
  <verify>cd web && npm run dev, click on episode text, dialog opens with season/episode pickers</verify>
  <done>Clicking episode info opens Jump to Episode dialog, changes persist</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Jump to Episode dialog for manual episode selection</what-built>
  <how-to-verify>
    1. Run: cd web && npm run dev
    2. Visit: http://localhost:3000/app/tonight
    3. Find a TV show, note current episode (e.g., S1E2)
    4. Click on episode text or menu button
    5. Verify: Dialog opens with Season and Episode dropdowns
    6. Change: Select a different season, confirm episode list updates
    7. Change: Select a different episode (e.g., S2E5)
    8. Click: Save
    9. Confirm: Dialog closes, card now shows S2E5
    10. Refresh: Episode persists (database updated)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd web && npx tsc --noEmit` passes
- [ ] `cd web && npm run build` succeeds
- [ ] JumpToEpisodeDialog component renders correctly
- [ ] Season dropdown populates from TMDB
- [ ] Episode dropdown updates when season changes
- [ ] Save persists new progress to database
- [ ] Tonight view updates to show new episode
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Human verified Jump to Episode functionality
- No TypeScript errors
- Phase 6 complete: Progress tracking fully implemented
</success_criteria>

<output>
After completion, create `.planning/phases/06-progress-tracking/06-03-SUMMARY.md` with:

---
phase: 06-progress-tracking
plan: 03
subsystem: ui
tags: [jump-to-episode, dialog, progress, episode-selection]

requires:
  - phase: 06-02
    provides: Tonight view with episode display
  - phase: 06-01
    provides: Progress API and TMDB episode functions
provides:
  - Jump to Episode dialog component
  - Manual episode selection capability
affects: [library-view, schedule-view]

tech-stack:
  added: []
  patterns:
    - Episode selection dialog with cascading dropdowns
    - TMDB season/episode data fetching in dialog

key-files:
  created:
    - web/components/jump-to-episode-dialog.tsx
  modified:
    - web/components/title-card.tsx
    - web/app/app/tonight/tonight-client.tsx

key-decisions: []
patterns-established:
  - "Jump to Episode dialog pattern"
issues-created: []
duration: Xmin
completed: YYYY-MM-DD
---

[Summary content per template]

**Phase 6 Complete**
- Episode progress tracking per profile per series ✓
- Mark watched advances progress ✓
- Jump to episode for corrections ✓
- Ready for Phase 7: Episode Grid
</output>
