---
phase: 08.1-schedule-ux
plan: 01
type: execute
---

<objective>
Improve schedule view UX by simplifying grid display and showing full episode details on click.

Purpose: Make schedule grid less cluttered and more informative by removing unnecessary poster thumbnails and showing episode-specific information.
Output: Cleaner schedule grid with title + episode number, dialog with full episode details, correct episode runtime from TMDB.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Key files to modify:
@web/app/app/schedule/schedule-client.tsx
@web/app/api/schedule/route.ts
@web/components/schedule-show-dialog.tsx

# Reference for episode info pattern:
@web/app/app/show/[id]/season/[seasonNumber]/episode/[episodeNumber]/episode-client.tsx

**Current issues:**
1. ShowBlock displays miniature poster (wastes space)
2. Runtime uses show average (episode_run_time[0]), not actual episode runtime
3. ScheduleShowDialog shows show info but NOT current episode details

**Established patterns:**
- Episode detail page shows still, title, overview, air date
- TMDB episode has runtime field for specific episode
- API already fetches currentEpisode with season/episode/title/stillPath
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update schedule API to use actual episode runtime</name>
  <files>web/app/api/schedule/route.ts</files>
  <action>
1. In enrichEntry for TV shows:
   - Currently uses `details.episode_run_time?.[0] || 30` from show details
   - Change to use `episodeDetails.runtime` from the already-fetched episode
   - Fallback chain: episodeDetails.runtime → details.episode_run_time?.[0] → 30

2. Update the currentEpisode interface to include runtime:
   ```typescript
   interface CurrentEpisode {
     season: number;
     episode: number;
     title: string;
     stillPath: string | null;
     runtime: number | null;  // Add this
     airDate: string | null;  // Add this for dialog
     overview: string | null; // Add this for dialog
   }
   ```

3. Populate these fields from episodeDetails when fetching

4. In the enriched entry, set runtime to:
   `currentEpisode?.runtime ?? details.episode_run_time?.[0] ?? 30`
  </action>
  <verify>API returns episode-specific runtime (check a show where episode runtime differs from show average)</verify>
  <done>Schedule API returns actual episode runtime and full episode info</done>
</task>

<task type="auto">
  <name>Task 2: Simplify ShowBlock to show title + episode only</name>
  <files>web/app/app/schedule/schedule-client.tsx</files>
  <action>
1. Update EnrichedScheduleEntry interface to include currentEpisode info:
   ```typescript
   interface CurrentEpisode {
     season: number;
     episode: number;
     title: string;
     stillPath: string | null;
     runtime: number | null;
     airDate: string | null;
     overview: string | null;
   }

   interface EnrichedScheduleEntry {
     // ... existing fields
     currentEpisode: CurrentEpisode | null;
   }
   ```

2. Update ShowBlock component:
   - Remove poster thumbnail entirely
   - Display: Title on first line
   - Display: S#E# on second line (or "Movie" for movies)
   - Keep time range on third line if space allows
   - Adjust width thresholds (isCompact, isVeryCompact) since no poster

3. Layout should be:
   - Full width for text content
   - Title (truncate if needed)
   - Episode info: "S1E5" for TV, nothing for movies
   - Time range if width > 100px
  </action>
  <verify>Schedule grid shows title + episode number without posters, layout is cleaner</verify>
  <done>ShowBlock displays title + episode without poster thumbnail</done>
</task>

<task type="auto">
  <name>Task 3: Update dialog to show full episode details</name>
  <files>web/components/schedule-show-dialog.tsx</files>
  <action>
1. Update EnrichedScheduleEntry interface to include currentEpisode

2. Redesign dialog layout for TV shows to show episode info:
   - Episode still image (large) at top instead of/alongside poster
   - Show title as header
   - Episode badge: "Season X, Episode Y"
   - Episode title
   - Air date
   - Episode overview (full, not truncated)
   - Runtime (from episode)
   - Streaming providers
   - Actions (reschedule, remove)

3. For movies, keep current poster-focused layout

4. Add fallback: if no episode still, use show poster

5. Import getStillUrl from images.ts
  </action>
  <verify>Clicking a TV show in schedule opens dialog with full episode details including still, title, overview</verify>
  <done>Schedule dialog shows complete episode information for TV shows</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Improved schedule UX with simplified grid and full episode details</what-built>
  <how-to-verify>
    1. Run: cd web && npm run dev
    2. Navigate to /app/schedule
    3. Verify grid shows title + episode number (no posters)
    4. Click a TV show - dialog should show:
       - Episode still image (or show poster fallback)
       - Show title
       - Episode number and title
       - Air date and runtime
       - Episode overview
       - Streaming providers
       - Reschedule and remove actions
    5. Verify runtime matches TMDB episode data (not show average)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd web && npm run build` succeeds
- [ ] Schedule grid shows title + episode without posters
- [ ] Episode runtime comes from TMDB episode details
- [ ] Dialog shows full episode info (still, title, overview, air date)
- [ ] Movies still display correctly
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Schedule grid is cleaner without miniature posters
- Clicking shows full episode information
- Runtime is accurate per-episode
</success_criteria>

<output>
After completion, create `.planning/phases/08.1-schedule-ux/08.1-01-SUMMARY.md`
</output>
